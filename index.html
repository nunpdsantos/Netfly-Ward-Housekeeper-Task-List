<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ward Housekeeper Schedule Guide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f4f7fb;
      --card-bg: #ffffff;
      --morning: #b3e5fc;
      --midday: #c8e6c9;
      --evening: #ffe082;
      --ongoing: #80cbc4;
      --weekly: #ffab91;
      --text-main: #123456;
      --accent: #0072ce;
      --accent-soft: #e1f0ff;
      --danger: #c62828;
      --shadow-soft: 0 4px 10px rgba(0, 0, 0, 0.08);
      --radius-lg: 18px;
      --radius-sm: 12px;
      --transition-fast: 0.18s ease-out;
      --transition-med: 0.25s ease-out;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top left, #e3f2fd, #f9f9fb);
      color: var(--text-main);
      padding: 1.2rem;
      display: flex;
      justify-content: center;
    }

    .app-shell {
      max-width: 1080px;
      width: 100%;
      background: var(--card-bg);
      border-radius: 24px;
      box-shadow: 0 18px 35px rgba(0, 0, 0, 0.12);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 90vh;
    }

    header {
      padding: 1.8rem 2rem 1rem;
      background: linear-gradient(120deg, #004f9e, #0072ce);
      color: white;
      position: relative;
    }

    header::after {
      content: "";
      position: absolute;
      inset: auto 0 0;
      height: 10px;
      background: linear-gradient(
        90deg,
        #b3e5fc,
        #c8e6c9,
        #ffe082,
        #80cbc4,
        #ffab91
      );
      opacity: 0.9;
    }

    header h1 {
      font-size: 1.8rem;
      letter-spacing: 0.03em;
      margin-bottom: 0.35rem;
    }

    header p {
      font-size: 0.95rem;
      opacity: 0.9;
    }

    .badge-row {
      margin-top: 0.75rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .badge {
      font-size: 0.8rem;
      padding: 0.2rem 0.65rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.65);
      background: rgba(255, 255, 255, 0.13);
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }

    main {
      padding: 1.4rem 1.7rem 1.6rem;
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1.3fr);
      gap: 1.3rem;
    }

    @media (max-width: 860px) {
      main {
        grid-template-columns: minmax(0, 1fr);
        padding: 1.2rem 1.1rem 1.4rem;
      }
    }

    /* Left column controls + tasks */
    .controls {
      margin-bottom: 0.9rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
      align-items: center;
    }

    .controls h2 {
      font-size: 1.1rem;
      margin-right: 0.5rem;
    }

    .chip-group {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .chip {
      border-radius: 999px;
      border: 1px solid #d0d7e2;
      padding: 0.3rem 0.75rem;
      font-size: 0.78rem;
      background: #f3f6fb;
      cursor: pointer;
      transition: background var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast),
        border-color var(--transition-fast), color var(--transition-fast);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .chip span.icon {
      font-size: 0.9rem;
    }

    .chip.active {
      background: var(--accent);
      border-color: var(--accent);
      color: #ffffff;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.18);
      transform: translateY(-1px);
    }

    .chip:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);
    }

    .chip:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .view-toggle {
      margin-left: auto;
      display: flex;
      gap: 0.4rem;
      font-size: 0.78rem;
      align-items: center;
    }

    .view-toggle button {
      border-radius: 999px;
      border: none;
      padding: 0.3rem 0.7rem;
      cursor: pointer;
      background: #e0ebff;
      color: #204070;
      font-size: 0.78rem;
      transition: background var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .view-toggle button.active {
      background: #ffffff;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);
      transform: translateY(-1px);
    }

    /* Progress */
    .progress-card {
      padding: 0.85rem 1rem;
      border-radius: var(--radius-lg);
      background: var(--accent-soft);
      border: 1px solid #c8d8f7;
      margin-bottom: 0.9rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      font-size: 0.85rem;
    }

    .progress-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.7rem;
      flex-wrap: wrap;
    }

    .progress-bar-outer {
      flex: 1;
      height: 10px;
      border-radius: 999px;
      background: #e0e6f2;
      overflow: hidden;
    }

    .progress-bar-inner {
      height: 100%;
      width: 0%;
      border-radius: inherit;
      background: linear-gradient(90deg, #0072ce, #00bfa5);
      transition: width var(--transition-med);
    }

    .progress-label {
      min-width: 80px;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    /* Task grid */
    .task-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
      gap: 0.9rem;
    }

    .task-card {
      background: #ffffff;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      border-top: 4px solid transparent;
      padding: 0.85rem 0.9rem 0.8rem;
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: transform var(--transition-fast),
        box-shadow var(--transition-fast), border-color var(--transition-fast);
    }

    .task-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.14);
    }

    .task-card.morning {
      border-top-color: var(--morning);
    }

    .task-card.midday {
      border-top-color: var(--midday);
    }

    .task-card.evening {
      border-top-color: var(--evening);
    }

    .task-card.ongoing {
      border-top-color: var(--ongoing);
    }

    .task-card.weekly {
      border-top-color: var(--weekly);
    }

    .task-header {
      display: flex;
      gap: 0.45rem;
      align-items: flex-start;
    }

    .task-checkbox {
      position: relative;
      width: 20px;
      height: 20px;
      border-radius: 6px;
      border: 2px solid #c3cad7;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f5f7fc;
      transition: border var(--transition-fast), background var(--transition-fast),
        transform var(--transition-fast);
    }

    .task-checkbox.checked {
      background: #0072ce;
      border-color: #00509f;
      transform: scale(1.02);
    }

    .task-checkbox span {
      color: white;
      font-size: 0.7rem;
      opacity: 0;
      transform: scale(0.6);
      transition: opacity var(--transition-fast), transform var(--transition-fast);
    }

    .task-checkbox.checked span {
      opacity: 1;
      transform: scale(1);
    }

    .task-title {
      font-size: 0.92rem;
      font-weight: 600;
      letter-spacing: 0.01em;
    }

    .task-subtitle {
      font-size: 0.78rem;
      color: #4b5a75;
      margin-top: 0.05rem;
    }

    .task-pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      margin-top: 0.25rem;
    }

    .pill {
      border-radius: 999px;
      font-size: 0.7rem;
      padding: 0.15rem 0.5rem;
      background: #eef2fb;
      color: #43506a;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      max-width: 100%;
      white-space: nowrap;
    }

    .pill span.icon {
      font-size: 0.85rem;
    }

    .task-body {
      font-size: 0.8rem;
      color: #505b72;
      margin-top: 0.25rem;
      line-height: 1.35;
    }

    .task-footer {
      margin-top: 0.4rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
      color: #7a8497;
    }

    .task-footer span.tag {
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 600;
    }

    .task-footer span.badge-soft {
      padding: 0.12rem 0.4rem;
      border-radius: 999px;
      background: #f4f6fb;
    }

    /* Right column: timeline + fun corner */
    .side-panel {
      display: flex;
      flex-direction: column;
      gap: 0.9rem;
    }

    .panel {
      border-radius: var(--radius-lg);
      padding: 0.9rem 1rem;
      background: #f4f7fb;
      border: 1px solid #dde4f1;
      box-shadow: 0 5px 12px rgba(0, 0, 0, 0.05);
      font-size: 0.8rem;
    }

    .panel h3 {
      font-size: 0.95rem;
      margin-bottom: 0.45rem;
    }

    .timeline {
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
    }

    .timeline-item {
      display: grid;
      grid-template-columns: 70px minmax(0, 1fr);
      gap: 0.6rem;
      align-items: center;
    }

    .timeline-time {
      font-size: 0.78rem;
      font-weight: 600;
      color: #334567;
    }

    .timeline-chip {
      padding: 0.25rem 0.55rem;
      border-radius: 999px;
      font-size: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      background: #ffffff;
      border: 1px dashed #cbd4e2;
    }

    .timeline-chip span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      display: inline-block;
    }

    .timeline-chip.morning span.dot {
      background: var(--morning);
    }
    .timeline-chip.midday span.dot {
      background: var(--midday);
    }
    .timeline-chip.evening span.dot {
      background: var(--evening);
    }

    .panel-footer-note {
      margin-top: 0.45rem;
      font-size: 0.72rem;
      color: #707b90;
    }

    .fun-panel p {
      margin-bottom: 0.4rem;
    }

    .fun-emoji {
      font-size: 1.4rem;
      margin-right: 0.2rem;
    }

    .fun-button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.3rem;
    }

    .fun-btn {
      font-size: 0.75rem;
      border-radius: 999px;
      border: 1px solid #d0d7e5;
      padding: 0.25rem 0.55rem;
      background: #ffffff;
      cursor: pointer;
      transition: background var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .fun-btn:hover {
      background: #edf3ff;
      transform: translateY(-1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
    }

    .small-muted {
      font-size: 0.7rem;
      color: #7b8496;
      margin-top: 0.4rem;
    }

    footer {
      padding: 0.5rem 1.7rem 1rem;
      font-size: 0.7rem;
      color: #6c7585;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 0.4rem;
      background: #f5f7fc;
      border-top: 1px solid #dde3f0;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <h1>Ward Housekeeper Schedule Guide</h1>
      <p>
        Tap a time block or task card as you work through your shift. Your
        progress is saved on this device.
      </p>
      <div class="badge-row">
        <span class="badge">‚è± Approx. 07:00 a.m. ‚Äì End of shift</span>
        <span class="badge">üçΩ Breakfast ¬∑ Lunch ¬∑ Supper</span>
        <span class="badge">üßº Pantry ¬∑ PPE ¬∑ Ordering</span>
      </div>
    </header>

    <main>
      <!-- LEFT: FILTERS + TASKS -->
      <section>
        <div class="controls">
          <h2>Shift section:</h2>
          <div class="chip-group" id="sectionFilters">
            <button class="chip active" data-section="all">
              <span class="icon">‚≠ê</span>All
            </button>
            <button class="chip" data-section="morning">
              <span class="icon">üåÖ</span>Morning
            </button>
            <button class="chip" data-section="midday">
              <span class="icon">‚òÄÔ∏è</span>Mid-day
            </button>
            <button class="chip" data-section="evening">
              <span class="icon">üåá</span>Afternoon &amp; Supper
            </button>
            <button class="chip" data-section="ongoing">
              <span class="icon">‚ôªÔ∏è</span>Ongoing
            </button>
            <button class="chip" data-section="weekly">
              <span class="icon">üìÖ</span>Weekly
            </button>
          </div>

          <div class="view-toggle" aria-label="Toggle card detail level">
            <span>View:</span>
            <button id="viewSummary" class="active">Compact</button>
            <button id="viewDetail">Detailed</button>
          </div>
        </div>

        <div class="progress-card" aria-live="polite">
          <div class="progress-row">
            <div>
              <strong>Section progress</strong>
            </div>
            <div class="progress-label">
              <span id="progressCount">0 / 0</span>
            </div>
          </div>
          <div class="progress-bar-outer" aria-hidden="true">
            <div class="progress-bar-inner" id="progressBar"></div>
          </div>
          <div class="small-muted">
            Tip: ticking tasks marks them as done for today. Use the
            <strong>Reset</strong> button in the fun corner to clear everything.
          </div>
        </div>

        <div class="task-grid" id="taskGrid"></div>
      </section>

      <!-- RIGHT: TIMELINE + FUN CORNER -->
      <aside class="side-panel">
        <div class="panel">
          <h3>Timeline overview</h3>
          <div class="timeline">
            <div class="timeline-item">
              <div class="timeline-time">07:00</div>
              <div class="timeline-chip morning">
                <span class="dot"></span> Breakfast &amp; fridge checks
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-time">09:00</div>
              <div class="timeline-chip morning">
                <span class="dot"></span> Bread &amp; milk stock / menus
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-time">10:30</div>
              <div class="timeline-chip morning">
                <span class="dot"></span> Tea round &amp; trolley
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-time">12:30</div>
              <div class="timeline-chip midday">
                <span class="dot"></span> Lunch service &amp; trays
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-time">15:00</div>
              <div class="timeline-chip midday">
                <span class="dot"></span> Afternoon tea &amp; PPE
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-time">17:30</div>
              <div class="timeline-chip evening">
                <span class="dot"></span> Supper &amp; late tea round
              </div>
            </div>
          </div>
          <p class="panel-footer-note">
            Use this as a quick ‚Äúmental map‚Äù of your day. Cards below give the
            detail.
          </p>
        </div>

        <div class="panel fun-panel">
          <h3>Fun corner</h3>
          <p>
            <span class="fun-emoji" aria-hidden="true">üéØ</span>
            <strong id="funPromptTitle">Quick challenge</strong>
          </p>
          <p id="funPromptText">
            Tick off all Morning tasks before 10:30 a.m. Can you get them all
            green?
          </p>
          <div class="fun-button-row">
            <button class="fun-btn" id="shufflePrompt">New challenge</button>
            <button class="fun-btn" id="resetProgress">
              Reset all ticks
            </button>
          </div>
          <p class="small-muted">
            Challenges are just for fun ‚Äì they don‚Äôt change the official
            schedule.
          </p>
        </div>
      </aside>
    </main>

    <footer>
      <span>Made from the Ward Housekeeper schedule &amp; task list.</span>
      <span>Progress is stored locally in this browser only.</span>
    </footer>
  </div>

  <script>
    // --- DATA -------------------------------------------------------------
    const tasks = [
      // MORNING
      {
        id: "serve_breakfast",
        section: "morning",
        title: "Serve breakfast",
        time: "07:00‚Äì09:00",
        approx: "Approx. 07:00‚Äì09:00 a.m.",
        description:
          "Serve breakfast trays, help patients with menus and dietary needs, and note any issues.",
        tag: "Breakfast"
      },
      {
        id: "fridge_freezer_check",
        section: "morning",
        title: "Fridge & freezer temp check",
        time: "Around 08:00",
        approx: "Fridge & freezer once this morning.",
        description:
          "Check and record temperatures for ward fridges and the freezer (Fridge < 5¬∞C / Freezer < -18¬∞C).",
        tag: "Food safety"
      },
      {
        id: "bread_milk_stock",
        section: "morning",
        title: "Check bread & milk levels",
        time: "By 09:00",
        approx: "Bread orders before 09:00; milk before 14:00.",
        description:
          "Check bread, milk, juices and other breakfast items. Order or cancel items via Helpdesk if needed.",
        tag: "Stock check"
      },
      {
        id: "tablet_menus_lunch",
        section: "morning",
        title: "Complete & upload lunch menus",
        time: "By 09:30",
        approx: "Ensure all lunch menus are on the tablet.",
        description:
          "Visit each patient, confirm their lunch choice and ensure menus are completed and uploaded on the tablet.",
        tag: "Tablet menus"
      },
      {
        id: "wash_breakfast_dishes",
        section: "morning",
        title: "Collect & wash breakfast dishes",
        time: "After breakfast",
        approx: "Once breakfast is finished.",
        description:
          "Collect all breakfast trays and dishes, run the dishwasher and leave the area clean.",
        tag: "Pantry"
      },
      {
        id: "tea_round_morning",
        section: "morning",
        title: "Morning tea round",
        time: "Around 10:30",
        approx: "Approx. 10:30 a.m.",
        description:
          "Complete the morning tea round, offering hot drinks and water top-ups to patients.",
        tag: "Drinks"
      },
      {
        id: "restock_tea_trolley",
        section: "morning",
        title: "Restock tea/breakfast trolley",
        time: "Morning",
        approx: "After tea round or as needed.",
        description:
          "Top up tea, coffee, sugar, milk, cups and other items so the trolley is ready for the next round.",
        tag: "Trolley"
      },
      {
        id: "nurse_station_iv_stock",
        section: "morning",
        title: "Restock nurse & IV station",
        time: "Late morning",
        approx: "Before lunch where possible.",
        description:
          "Check the nurse station and IV station supplies and restock required consumables.",
        tag: "Ward stock"
      },
      {
        id: "prepare_lunch_trays",
        section: "morning",
        title: "Prepare lunch trays",
        time: "Before 12:30",
        approx: "Just before lunch arrives.",
        description:
          "Set up trays, cutlery and napkins ready for lunch service.",
        tag: "Lunch prep"
      },

      // MIDDAY
      {
        id: "assist_lunch",
        section: "midday",
        title: "Assist with lunch service",
        time: "12:30‚Äì13:30",
        approx: "Approx. 12:30 p.m.",
        description:
          "Help Catering serve lunch, ensure patients receive the correct meals and assist where needed.",
        tag: "Lunch"
      },
      {
        id: "collect_lunch_trays",
        section: "midday",
        title: "Collect lunch trays",
        time: "After lunch",
        approx: "Once patients are finished.",
        description:
          "Collect all lunch trays and return them for washing, leaving over-bed tables clear.",
        tag: "Clear up"
      },
      {
        id: "afternoon_tea_round",
        section: "midday",
        title: "Afternoon tea round",
        time: "Mid-afternoon",
        approx: "After lunch trays have gone.",
        description:
          "Offer hot drinks and water to patients during the afternoon.",
        tag: "Drinks"
      },
      {
        id: "restock_ppe_wipes",
        section: "midday",
        title: "Restock PPE & Clinell wipes",
        time: "Afternoon",
        approx: "Top-ups during the day.",
        description:
          "Ensure gloves, aprons, masks and Clinell wipes are fully stocked throughout the ward and in all rooms.",
        tag: "Infection control"
      },
      {
        id: "collect_next_day_menus",
        section: "midday",
        title: "Check next-day menus (lunch & supper)",
        time: "By 13:30 for supper menus",
        approx: "Menus completed & uploaded.",
        description:
          "Visit each patient to complete or confirm next-day lunch and supper menus on the tablet.",
        tag: "Tablet menus"
      },

      // EVENING
      {
        id: "assist_supper",
        section: "evening",
        title: "Assist with supper service",
        time: "17:30‚Äì18:30",
        approx: "Approx. 17:30 p.m.",
        description:
          "Deliver supper trays provided by Catering and make sure each patient has the correct meal.",
        tag: "Supper"
      },
      {
        id: "collect_supper_trays",
        section: "evening",
        title: "Collect supper trays",
        time: "After supper",
        approx: "Once patients are finished.",
        description:
          "Collect all supper trays and return them, leaving patient areas clear.",
        tag: "Clear up"
      },
      {
        id: "late_tea_round",
        section: "evening",
        title: "Late tea round",
        time: "Evening",
        approx: "After supper trays.",
        description:
          "Offer final hot drinks and water to patients before the end of the shift.",
        tag: "Drinks"
      },
      {
        id: "prepare_trolleys_next_day",
        section: "evening",
        title: "Prepare breakfast & tea trolleys for next day",
        time: "End of shift",
        approx: "Before handover.",
        description:
          "Clean and restock the breakfast and tea trolleys so they are ready for the next morning.",
        tag: "Next day"
      },

      // ONGOING
      {
        id: "drinks_water_topups",
        section: "ongoing",
        title: "Drinks & fresh water",
        time: "All day",
        approx: "Throughout the shift.",
        description:
          "Provide extra drinks on request and ensure fresh water jugs are available and topped up.",
        tag: "Hydration"
      },
      {
        id: "pantry_clean_dated",
        section: "ongoing",
        title: "Pantry clean & date checks",
        time: "All day",
        approx: "Little & often.",
        description:
          "Keep the pantry tidy; ensure opened items are dated and dispose of expired or undated food.",
        tag: "Pantry"
      },
      {
        id: "ariba_ordering",
        section: "ongoing",
        title: "Ariba ordering (if needed)",
        time: "When required",
        approx: "Check during the day.",
        description:
          "Check stock of bowls, cutlery, plates, paper roll, soups, sugar, blue cups and order via Ariba when needed.",
        tag: "Ordering"
      },
      {
        id: "clean_cupboards_microwave_fridge",
        section: "ongoing",
        title: "Clean cupboards, microwave, fridge & freezer",
        time: "When suitable",
        approx: "Avoid busy service times.",
        description:
          "Wipe down internal surfaces of cupboards, microwave and cold storage to maintain hygiene.",
        tag: "Cleaning"
      },
      {
        id: "dishwasher_drain_refill",
        section: "ongoing",
        title: "Dishwasher drain & refill",
        time: "Start & end of shift",
        approx: "At least twice daily.",
        description:
          "Drain and refill the dishwasher water, checking detergent, sanitiser and salt levels; clean the filter.",
        tag: "Dishwasher"
      },
      {
        id: "keep_kitchen_clean",
        section: "ongoing",
        title: "Keep kitchen / pantry clean",
        time: "All day",
        approx: "Little jobs between rounds.",
        description:
          "Wipe surfaces, remove rubbish and keep the area safe and tidy as you go.",
        tag: "Housekeeping"
      },
      {
        id: "rotate_food_fifo",
        section: "ongoing",
        title: "Rotate food using FIFO",
        time: "All day",
        approx: "When handling food items.",
        description:
          "Check expiry dates, rotate stock using First In, First Out and remove out-of-date supplements or food.",
        tag: "Stock rotation"
      },

      // WEEKLY
      {
        id: "patient_boards_leaflets",
        section: "weekly",
        title: "Patient boards & leaflets tidy",
        time: "Weekly",
        approx: "Once per week.",
        description:
          "Check patient information boards and leaflet holders, tidy and remove out-of-date materials.",
        tag: "Patient info"
      },
      {
        id: "clean_mobile_equipment",
        section: "weekly",
        title: "Clean mobile equipment",
        time: "Weekly",
        approx: "Once per week.",
        description:
          "Clean drip stands, mobile computers, phones, drip trolleys and folder trolleys according to guidance.",
        tag: "Equipment"
      },
      {
        id: "flush_taps_logbook",
        section: "weekly",
        title: "Flush taps & update logbook",
        time: "Twice weekly",
        approx: "e.g. Tuesdays & Saturdays.",
        description:
          "Flush all ward taps, including patient rooms and wall-mounted sinks, and record each flush in the logbook.",
        tag: "Water safety"
      }
    ];

    const funPrompts = [
      {
        title: "Quick challenge",
        text: "Tick off every Morning task before you sit down for your own tea break."
      },
      {
        title: "Hydration hero",
        text: "Each time you top up a water jug, tick a task and see how fast the bar fills up."
      },
      {
        title: "Pantry perfection",
        text: "Can you keep the pantry spotless all shift? Use the Ongoing cards as a mini checklist."
      },
      {
        title: "Weekly wizard",
        text: "Pick one Weekly task and make it your mission to get it done before handover."
      },
      {
        title: "Tablet pro",
        text: "Try to complete all menu-related tasks with no missed beds today."
      }
    ];

    const STORAGE_KEY = "ward_housekeeper_tasks_v1";

    // --- STATE ------------------------------------------------------------
    let completed = loadCompleted();
    let activeSection = "all";
    let compactView = true;

    // --- DOM REFS ---------------------------------------------------------
    const taskGrid = document.getElementById("taskGrid");
    const sectionFilters = document.getElementById("sectionFilters");
    const progressBar = document.getElementById("progressBar");
    const progressCount = document.getElementById("progressCount");
    const viewSummaryBtn = document.getElementById("viewSummary");
    const viewDetailBtn = document.getElementById("viewDetail");
    const funPromptTitle = document.getElementById("funPromptTitle");
    const funPromptText = document.getElementById("funPromptText");
    const shufflePromptBtn = document.getElementById("shufflePrompt");
    const resetProgressBtn = document.getElementById("resetProgress");

    // --- INITIAL RENDER ---------------------------------------------------
    renderTasks();
    updateProgress();
    pickRandomPrompt();

    // --- EVENT HANDLERS ---------------------------------------------------
    sectionFilters.addEventListener("click", (e) => {
      const chip = e.target.closest(".chip");
      if (!chip) return;
      document
        .querySelectorAll("#sectionFilters .chip")
        .forEach((c) => c.classList.remove("active"));
      chip.classList.add("active");
      activeSection = chip.getAttribute("data-section");
      renderTasks();
      updateProgress();
    });

    viewSummaryBtn.addEventListener("click", () => {
      compactView = true;
      viewSummaryBtn.classList.add("active");
      viewDetailBtn.classList.remove("active");
      document.body.classList.add("compact-view");
      renderTasks();
    });

    viewDetailBtn.addEventListener("click", () => {
      compactView = false;
      viewDetailBtn.classList.add("active");
      viewSummaryBtn.classList.remove("active");
      document.body.classList.remove("compact-view");
      renderTasks();
    });

    shufflePromptBtn.addEventListener("click", pickRandomPrompt);

    resetProgressBtn.addEventListener("click", () => {
      if (
        !confirm(
          "Reset all ticks for every task on this device? This cannot be undone."
        )
      )
        return;
      completed = {};
      saveCompleted();
      renderTasks();
      updateProgress();
    });

    // --- FUNCTIONS --------------------------------------------------------
    function renderTasks() {
      taskGrid.innerHTML = "";
      const filtered = tasks.filter(
        (t) => activeSection === "all" || t.section === activeSection
      );

      filtered.forEach((task) => {
        const card = document.createElement("article");
        card.className = `task-card ${task.section}`;
        card.setAttribute("data-id", task.id);

        const header = document.createElement("div");
        header.className = "task-header";

        const checkbox = document.createElement("div");
        checkbox.className = "task-checkbox";
        checkbox.innerHTML = "<span>‚úì</span>";
        if (completed[task.id]) checkbox.classList.add("checked");

        const titleWrap = document.createElement("div");
        const title = document.createElement("div");
        title.className = "task-title";
        title.textContent = task.title;

        const subtitle = document.createElement("div");
        subtitle.className = "task-subtitle";
        subtitle.textContent = task.approx;

        titleWrap.appendChild(title);
        titleWrap.appendChild(subtitle);

        header.appendChild(checkbox);
        header.appendChild(titleWrap);

        const pillRow = document.createElement("div");
        pillRow.className = "task-pill-row";

        if (task.time) {
          const timePill = document.createElement("span");
          timePill.className = "pill";
          timePill.innerHTML = `<span class="icon">‚è∞</span>${task.time}`;
          pillRow.appendChild(timePill);
        }

        if (task.tag) {
          const tagPill = document.createElement("span");
          tagPill.className = "pill";
          tagPill.innerHTML = `<span class="icon">üè∑</span>${task.tag}`;
          pillRow.appendChild(tagPill);
        }

        const body = document.createElement("div");
        body.className = "task-body";
        body.textContent = task.description;
        if (compactView) body.style.display = "none";

        const footer = document.createElement("div");
        footer.className = "task-footer";
        footer.innerHTML = `<span class="tag">${task.section.toUpperCase()}</span>
          <span class="badge-soft">${
            completed[task.id] ? "Marked as done" : "Tap to mark done"
          }</span>`;

        card.appendChild(header);
        card.appendChild(pillRow);
        card.appendChild(body);
        card.appendChild(footer);

        // click handling
        card.addEventListener("click", (event) => {
          // If user clicks inside checkbox or anywhere on card, toggle checked.
          toggleTask(task.id, card);
        });

        taskGrid.appendChild(card);
      });
    }

    function toggleTask(id, card) {
      const checkbox = card.querySelector(".task-checkbox");
      const footerBadge = card.querySelector(".badge-soft");

      const currentlyDone = !!completed[id];
      completed[id] = !currentlyDone;
      if (!completed[id]) {
        delete completed[id];
      }

      checkbox.classList.toggle("checked", !!completed[id]);
      footerBadge.textContent = completed[id]
        ? "Marked as done"
        : "Tap to mark done";

      saveCompleted();
      updateProgress();
      maybeCelebrate();
    }

    function updateProgress() {
      const filtered = tasks.filter(
        (t) => activeSection === "all" || t.section === activeSection
      );
      const done = filtered.filter((t) => completed[t.id]).length;
      const total = filtered.length || 1;
      const percent = Math.round((done / total) * 100);
      progressBar.style.width = percent + "%";
      progressCount.textContent = `${done} / ${total}`;
    }

    function maybeCelebrate() {
      // Simple little celebration when all tasks in current section are done.
      const filtered = tasks.filter(
        (t) => activeSection === "all" || t.section === activeSection
      );
      if (!filtered.length) return;
      const allDone = filtered.every((t) => completed[t.id]);
      if (allDone) {
        const sectionName =
          activeSection === "all"
            ? "all sections"
            : activeSection.charAt(0).toUpperCase() + activeSection.slice(1);
        alert(`Great work ‚Äì you've ticked every task in ${sectionName}! üéâ`);
      }
    }

    function saveCompleted() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(completed));
      } catch (e) {
        // ignore storage errors
      }
    }

    function loadCompleted() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : {};
      } catch (e) {
        return {};
      }
    }

    function pickRandomPrompt() {
      const idx = Math.floor(Math.random() * funPrompts.length);
      const prompt = funPrompts[idx];
      funPromptTitle.textContent = prompt.title;
      funPromptText.textContent = prompt.text;
    }
  </script>
</body>
</html>
